<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>How Toddler plays :: Cong&#39;s little space — A little technical blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Back when I first started looking into making the manager (like 4 years ago), looking through Github&amp;rsquo;s projects on automating Tribal Wars 2, I found most, if not all, of the projects relies on automating the browser instead of utilising the the game&amp;rsquo;s WebSocket connection. Therefore, I think it&amp;rsquo;s worthwhile to capture the essence of how the game client talks to the game server. Hopefully, this blog post may be helpful to those looking to automate this game."/>
<meta name="keywords" content=", "/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://congx.dev/posts/how-toddler-plays/" />


<link rel="stylesheet" href="https://congx.dev/assets/style.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://congx.dev/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="https://congx.dev/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="How Toddler plays :: Cong&#39;s little space — A little technical blog" />
<meta name="twitter:description" content="Back when I first started looking into making the manager (like 4 years ago), looking through Github&amp;rsquo;s projects on automating Tribal Wars 2, I found most, if not all, of the projects relies on automating the browser instead of utilising the the game&amp;rsquo;s WebSocket connection. Therefore, I think it&amp;rsquo;s worthwhile to capture the essence of how the game client talks to the game server. Hopefully, this blog post may be helpful to those looking to automate this game." />
<meta name="twitter:site" content="https://congx.dev/" />
<meta name="twitter:creator" content="Cong Nguyen" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How Toddler plays :: Cong&#39;s little space — A little technical blog">
<meta property="og:description" content="Back when I first started looking into making the manager (like 4 years ago), looking through Github&amp;rsquo;s projects on automating Tribal Wars 2, I found most, if not all, of the projects relies on automating the browser instead of utilising the the game&amp;rsquo;s WebSocket connection. Therefore, I think it&amp;rsquo;s worthwhile to capture the essence of how the game client talks to the game server. Hopefully, this blog post may be helpful to those looking to automate this game." />
<meta property="og:url" content="https://congx.dev/posts/how-toddler-plays/" />
<meta property="og:site_name" content="How Toddler plays" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2019-09-20 16:16:00 &#43;1100 &#43;1100" />











</head>
<body class="">


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Cong&#39;s little blog
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/readme">README</a></li>
        
      
        
          <li><a href="/toc">T.O.C</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/readme">README</a></li>
      
    
      
        <li><a href="/toc">T.O.C</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://congx.dev/posts/how-toddler-plays/">How Toddler plays</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2019-09-20
    </span>
    
    
    <span class="post-author">::
      Cong Nguyen
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://congx.dev/tags/toddler/">toddler</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    <p>Back when I first started looking into making the manager (like 4 years ago), looking through Github&rsquo;s projects on automating Tribal Wars 2, I found most, if not all, of the projects relies on automating the browser instead of utilising the the game&rsquo;s WebSocket connection. Therefore, I think it&rsquo;s worthwhile to capture the essence of how the game client talks to the game server. Hopefully, this blog post may be helpful to those looking to automate this game.</p>

<p>When Tribal Wars 2 website is loaded, a websocket is connected using Socket.io 2.0.</p>

<p><img src="./socket-io-connection.png" alt="socketiO connection" /></p>

<p>Messages sent between the game client (browser or mobile) and server includes metadata from Socket.io 2.0 library and looks something like the screenshot below. In the screenshot shown, green arrows denote messages sent to the server from the browser, and red arrows denote messages received from the server.</p>

<p><img src="./frames.png" alt="frames" /></p>

<p>There are 3 types of messages that are sent between the game server and the client:</p>

<ul>
<li>Request/response messages. As an example, the highlighted line in the picture above is requesting for global world&rsquo;s information <code>GlobalInformation/getInfo</code>. The request has an <code>id</code> of 8. A few lines after this line, another message with <code>id</code> 8 is sent from the server to the client with type <code>GlobalInformation/info</code>. This is the response for the <code>get</code> request.</li>
<li>Fire-forget message from the client to the server. The most notable and only example of this is when the client requests server for future notifications.</li>
<li>Notifications from the server to the client. These messages are special in which the <code>id</code> of the message is <code>null</code>.</li>
</ul>

<p><img src="./message-types.png" alt="types" /></p>

<p>The screenshot above shows the cleaned version of different types of messages. <code>42[&quot;msg&quot;</code>, portion and <code>&quot;headers&quot;</code> portion is removed from the message above.</p>

<p>You can visit this <a href="https://gist.github.com/rampadc/d719d60a2e359670808f862712bcb9ae">Gist</a> to look at what some captured messages look like, and <a href="https://gist.github.com/rampadc/6b76bc3c00d94d7ac2cfad9999de737b">examples of report JSONs</a>.</p>

<p>For a Javascript example of how the authentication sequence work, have a look at the <a href="https://github.com/rampadc/toddler-auth">toddler-auth</a> project.</p>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <span class="button previous">
        <a href="https://congx.dev/posts/xpsl-docs-motivation-overview/xpsl-docs-overview-and-motivation/">
          <span class="button__icon">←</span>
          <span class="button__text">XPSL Docs: Motivation and Overview</span>
        </a>
      </span>
      
      
      <span class="button next">
        <a href="https://congx.dev/posts/logging-with-papertrail/">
          <span class="button__text">Logging with Papertrail</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2019 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://congx.dev/assets/main.js"></script>
<script src="https://congx.dev/assets/prism.js"></script>





  
</div>

</body>
</html>
